{"ast":null,"code":"import _toConsumableArray from\"/Users/tangchenlong/Desktop/react-demo/react-admin-demos/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/tangchenlong/Desktop/react-demo/react-admin-demos/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{message,Modal}from\"antd\";import{useEffect,useState}from\"react\";import{initGameDatas}from\"../../lib/initData\";export var useGameHook=function useGameHook(){var _useState=useState(\"Block\"),_useState2=_slicedToArray(_useState,2),currentPlayer=_useState2[0],setCurrentPlayer=_useState2[1];var _useState3=useState([3,5,7]),_useState4=_slicedToArray(_useState3,2),settingDatas=_useState4[0],setSettingDatas=_useState4[1];var _useState5=useState(initGameDatas(settingDatas)),_useState6=_slicedToArray(_useState5,2),initGames=_useState6[0],setInitGames=_useState6[1];var _useState7=useState(initGames),_useState8=_slicedToArray(_useState7,2),gamesDatas=_useState8[0],setGamesDatas=_useState8[1];var _useState9=useState(-1),_useState10=_slicedToArray(_useState9,2),currentAllowSetPieceLine=_useState10[0],setCurrentAllowSetPieceLine=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),gamesFinish=_useState12[0],setGamesFinish=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),currentChoosePiece=_useState14[0],setCurrentChoosePiece=_useState14[1];var handleClickChangeCurrentPlayer=function handleClickChangeCurrentPlayer(){if(!currentChoosePiece.length){message.info(\"请走棋\");return;}var player=currentPlayer===\"White\"?\"Block\":\"White\";setCurrentPlayer(player);setCurrentAllowSetPieceLine(-1);setCurrentChoosePiece([]);};useEffect(function(){var Datas=gamesDatas.flat(Infinity);var gamesFinishFlag=Datas.reduce(function(arr,item){return arr&&item.disable;},true);if(gamesFinishFlag){var player=currentPlayer===\"White\"?\"Block\":\"White\";Modal.success({title:\"游戏结束\",content:\"\".concat(player,\"\\u83B7\\u80DC\")});}},[gamesDatas]);useEffect(function(){setInitGames(initGameDatas(settingDatas));},[settingDatas]);useEffect(function(){resetInitGamesDatas();},[initGames]);var resetInitGamesDatas=function resetInitGamesDatas(){setGamesDatas(initGames);setCurrentPlayer(\"Block\");setCurrentAllowSetPieceLine(-1);};var handleClickBox=function handleClickBox(box){if(noAllowSetPiece(box)){return;}setPiece(box);};var noAllowSetPiece=function noAllowSetPiece(box){if(currentAllowSetPieceLine>-1&&box.line!==currentAllowSetPieceLine||box.disable){return true;}setCurrentAllowSetPieceLine(box.line);return false;};var setPiece=function setPiece(box){var line=box.line,row=box.row;setCurrentChoosePiece([].concat(_toConsumableArray(currentChoosePiece),[box]));setGamesDatas(function(item){var _item=JSON.parse(JSON.stringify(item));_item[line][row].disable=true;_item[line][row].currentPlayer=currentPlayer;return _item;});};var handleClickReset=function handleClickReset(){Modal.confirm({content:\"\\u786E\\u8BA4\\u91CD\\u73A9\\u4E48\\uFF1F\",okText:\"重玩\",cancelText:\"取消\",onOk:function onOk(){resetInitGamesDatas();},onCancel:function onCancel(){}});};var handleClickSetting=function handleClickSetting(){resetInitGamesDatas();};return{handleClickChangeCurrentPlayer:handleClickChangeCurrentPlayer,currentPlayer:currentPlayer,setCurrentPlayer:setCurrentPlayer,gamesDatas:gamesDatas,handleClickBox:handleClickBox,gamesFinish:gamesFinish,handleClickReset:handleClickReset,handleClickSetting:handleClickSetting,settingDatas:settingDatas,setSettingDatas:setSettingDatas};};","map":{"version":3,"sources":["/Users/tangchenlong/Desktop/react-demo/react-admin-demos/src/components/games/hook.tsx"],"names":["message","Modal","useEffect","useState","initGameDatas","useGameHook","currentPlayer","setCurrentPlayer","settingDatas","setSettingDatas","initGames","setInitGames","gamesDatas","setGamesDatas","currentAllowSetPieceLine","setCurrentAllowSetPieceLine","gamesFinish","setGamesFinish","currentChoosePiece","setCurrentChoosePiece","handleClickChangeCurrentPlayer","length","info","player","Datas","flat","Infinity","gamesFinishFlag","reduce","arr","item","disable","success","title","content","resetInitGamesDatas","handleClickBox","box","noAllowSetPiece","setPiece","line","row","_item","JSON","parse","stringify","handleClickReset","confirm","okText","cancelText","onOk","onCancel","handleClickSetting"],"mappings":"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","sourcesContent":["import { message, Modal } from \"antd\";\nimport { useEffect, useMemo, useState } from \"react\";\nimport { gameDatas, initGameDatas } from \"../../lib/initData\";\nimport { IBox, IPlayer } from \"../../type/types\";\n\nexport const useGameHook = () => {\n  const [currentPlayer, setCurrentPlayer] = useState(\"Block\");\n  const [settingDatas, setSettingDatas] = useState([3, 5, 7]);\n  const [initGames, setInitGames] = useState(initGameDatas(settingDatas));\n  const [gamesDatas, setGamesDatas] = useState(initGames);\n  const [currentAllowSetPieceLine, setCurrentAllowSetPieceLine] = useState(-1);\n  const [gamesFinish, setGamesFinish] = useState(false);\n  const [currentChoosePiece, setCurrentChoosePiece] = useState(\n    [] as Array<IBox>\n  );\n\n  const handleClickChangeCurrentPlayer = () => {\n    if (!currentChoosePiece.length) {\n      message.info(\"请走棋\");\n      return;\n    }\n    const player = currentPlayer === \"White\" ? \"Block\" : \"White\";\n    setCurrentPlayer(player);\n    setCurrentAllowSetPieceLine(-1);\n    setCurrentChoosePiece([]);\n  };\n\n  useEffect(() => {\n    let Datas: any = gamesDatas.flat(Infinity);\n    const gamesFinishFlag = Datas.reduce((arr: any, item: IBox) => {\n      return arr && item.disable;\n    }, true);\n    if (gamesFinishFlag) {\n      const player = currentPlayer === \"White\" ? \"Block\" : \"White\";\n      Modal.success({\n        title: \"游戏结束\",\n        content: `${player}获胜`,\n      });\n    }\n  }, [gamesDatas]);\n\n  useEffect(() => {\n    setInitGames(initGameDatas(settingDatas));\n  }, [settingDatas]);\n\n  useEffect(() => {\n    resetInitGamesDatas();\n  }, [initGames]);\n\n  const resetInitGamesDatas = () => {\n    setGamesDatas(initGames);\n    setCurrentPlayer(\"Block\");\n    setCurrentAllowSetPieceLine(-1);\n  };\n\n  const handleClickBox = (box: IBox) => {\n    if (noAllowSetPiece(box)) {\n      return;\n    }\n    setPiece(box);\n  };\n\n  const noAllowSetPiece = (box: IBox) => {\n    if (\n      (currentAllowSetPieceLine > -1 &&\n        box.line !== currentAllowSetPieceLine) ||\n      box.disable\n    ) {\n      return true;\n    }\n    setCurrentAllowSetPieceLine(box.line);\n    return false;\n  };\n\n  const setPiece = (box: IBox) => {\n    const { line, row } = box;\n    setCurrentChoosePiece([...currentChoosePiece, box]);\n    setGamesDatas((item) => {\n      const _item = JSON.parse(JSON.stringify(item));\n      _item[line][row].disable = true;\n      _item[line][row].currentPlayer = currentPlayer as IPlayer;\n      return _item;\n    });\n  };\n\n  const handleClickReset = () => {\n    Modal.confirm({\n      content: `确认重玩么？`,\n      okText: \"重玩\",\n      cancelText: \"取消\",\n      onOk: () => {\n        resetInitGamesDatas();\n      },\n      onCancel: () => {},\n    });\n  };\n\n  const handleClickSetting = () => {\n    resetInitGamesDatas();\n  };\n\n  return {\n    handleClickChangeCurrentPlayer,\n    currentPlayer,\n    setCurrentPlayer,\n    gamesDatas,\n    handleClickBox,\n    gamesFinish,\n    handleClickReset,\n    handleClickSetting,\n    settingDatas,\n    setSettingDatas,\n  };\n};\n"]},"metadata":{},"sourceType":"module"}